(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"36ee":function(e,t,s){"use strict";s("85b6")},"61de":function(e,t,s){},"659d":function(e,t,s){"use strict";s("61de")},"85b6":function(e,t,s){},bdc2:function(e,t,s){},dbd2:function(e,t,s){"use strict";s("bdc2")},f157:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row q-col-gutter-xs q-pa-md"},[s("div",{staticClass:"col-12 row items-center q-mb-md relative-position"},[s("q-icon",{staticClass:"q-mr-lg cursor-pointer",attrs:{name:"reply",color:"purple",size:"md"},on:{click:function(t){return e.$router.go(-1)}}}),s("q-icon",{staticClass:"absolute-top-right cursor-pointer",staticStyle:{top:"10px"},attrs:{name:"info",color:"purple",size:"md"},on:{click:e.showInfo}})],1),s(e.component,{tag:"component",attrs:{expanded:e.expanded,albumId:e.$route.params.albumId}}),s("q-footer",{staticClass:"q-pa-none"},[s("q-tabs",{staticClass:"text-white bg-purple tab-gallery",attrs:{dense:"","indicator-color":"purple-2",align:"justify"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[s("q-tab",{attrs:{ripple:{color:"orange"},name:"fotos",icon:"photo",label:"Imagens"},on:{click:function(t){return e.toggleComponent()}}}),s("q-tab",{attrs:{ripple:{color:"orange"},name:"videos",icon:"movie",label:"VÃ­deos"},on:{click:function(t){return e.toggleComponent()}}})],1)],1),s("DialogAlbum",{attrs:{isOpen:e.dialog,isEdit:!0,album:e.album},on:{closeDialog:function(t){e.dialog=!1}}})],1)},i=[],a=(s("e6cf"),s("ddb0"),function(){var e=this,t=this,s=t.$createElement,o=t._self._c||s;return o("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"row q-col-gutter-xs q-mb-xl",staticStyle:{width:"100%"}},[o("q-page-sticky",{ref:"optionsSticker",staticClass:"options-order",class:[{"bg-grey-9":t.$q.dark.isActive},{"bg-grey-4":!t.$q.dark.isActive}],attrs:{position:"top",expand:""}},[o("div",{staticClass:"col-12 w-100 row justify-between items-center q-px-sm"},[o("div",[o("q-toggle",{staticClass:"col",attrs:{color:"purple",value:!t.isDisabled,z:"",label:"ordenar"},on:{input:function(e){t.isDisabled=!t.isDisabled}}})],1),o("div",[t.isDisabled?t._e():o("q-btn",{staticClass:"col",attrs:{label:"Salvar",color:"green",size:"sm"},on:{click:t.toOrderImages}})],1)])]),o("draggable",t._b({staticClass:"col-12 row",attrs:{disabled:t.isDisabled},model:{value:t.photos,callback:function(e){t.photos=e},expression:"photos"}},"draggable",t.dragOptions,!1),[o("transition-group",{staticClass:"col-12 row q-col-gutter-xs",attrs:{type:"transition",name:"flip-list"}},t._l(t.photos,(function(e){return o("div",{key:e.id,ref:"image",refInFor:!0,staticClass:"col-4 col-md-3 col-lg-2 relative-position row cursor-grab"},[o("img",{staticClass:"d-block no-border-radius",attrs:{src:e.im_foto,"spinner-color":"purple",width:"100%"}}),o("q-btn",{staticClass:"absolute-top-right",staticStyle:{top:"16px",right:"10px"},attrs:{icon:"more_vert",color:"purple",size:"md",round:""},on:{click:function(){t.isOpenOptions=!0,t.imageToDelete=e}}})],1)})),0)],1),o("q-file",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"inputFileAvatar",attrs:{accept:".jpg, .jpeg,.webp, .png"},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}}),o("DialogCrooper",{attrs:{isOpen:t.isOpenCrooper&&!t.wasSend,file:this.file,ratio:9/16},on:{sendImage:function(e){return t.sendImage(e)},hide:function(){e.isOpen=!1,e.isOpenCrooper=!1,e.file=null}}}),o("DialogConfirmDelete",{attrs:{isOpenOptions:t.isOpenOptions},on:{hideConfirmDelete:function(e){t.isOpenOptions=!1},deletePhoto:function(){t.isOpenOptions=!1,t.deletePhotoAlbum({photoId:t.imageToDelete.id,imageUrl:t.imageToDelete.im_foto,albumId:t.albumId})}}}),o("q-page-sticky",{staticStyle:{"z-index":"2"},attrs:{position:"bottom-right",offset:[18,18]}},[o("q-btn",{attrs:{fab:"",icon:"add",color:"accent"},on:{click:t.pickImage}})],1),o("q-resize-observer",{on:{resize:t.onResize}})],1)}),n=[],r=s("ded3"),l=s.n(r),d=(s("a79d"),s("1c16")),c=s("9149"),u=s("2f62"),h=s("b76a"),p=s.n(h),m={props:{expanded:{type:Boolean,required:!0},albumId:{type:String,required:!0}},watch:{file(){this.file&&(this.wasSend&&this.updateWasSend(!this.wasSend),this.isOpenCrooper=!0)}},data(){return{isOpen:!1,isOpenCrooper:!1,images:[],isOpenOptions:!1,imageToDelete:null,file:[],widthContainer:0,alreadyLoadedPhotos:!1,isDisabled:!0,newOrder:[]}},created(){this.setPhotosCarrousel()},components:{DialogCrooper:()=>Promise.all([s.e(0),s.e(1)]).then(s.bind(null,"619d")),DialogConfirmDelete:()=>Promise.all([s.e(0),s.e(2)]).then(s.bind(null,"075c")),draggable:p.a},computed:l()(l()({},Object(u["d"])({userUid:e=>e.acompanhantes.userId,wasSend:e=>e.fotosEvideos.wasSend})),{},{photos:{get(){let e=[];return this.$store.state.fotosEvideos.photosAlbum.forEach(((t,s)=>{t.albumId===this.albumId&&(e=this.$store.state.fotosEvideos.photosAlbum[s].photos)})),e},set(e){this.newOrder=[],this.newOrder=[...e],console.log(this.newOrder),this.$store.commit("fotosEvideos/updateOrderPhotos",{albumId:this.albumId,photos:e})}},dragOptions(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}}),methods:l()(l()(l()({},Object(u["b"])({setPhotoAlbum:"fotosEvideos/setPhotoAlbumAction",getPhotosAlbum:"fotosEvideos/getPhotosAlbumAction",deletePhotoAlbum:"fotosEvideos/deletePhotoAlbumAction"})),Object(u["c"])({updateWasSend:"fotosEvideos/updateWasSend"})),{},{openEditPhoto(e){alert("clickou")},sendImage(e){let t=[...this.photos];this.setPhotoAlbum({albumId:this.albumId,userUid:this.userUid,photo:e,nuSequencia:t.length})},pickImage(){this.$refs.inputFileAvatar.pickFiles()},onResize(e){e&&(this.widthContainer=e.width,this.$refs.optionsSticker.$el.style.width=e.width-96+"px"),this.expanded&&(this.$refs.optionsSticker.$el.style.left="340px")},openDialog(){this.isOpen=!0,this.$store.commit("fotosEvideos/updateWasSend",!1)},setPhotosCarrousel(){let e=[];this.$firebase.firestore().collection("acompanhante").doc(this.userUid).collection("albuns").doc(this.albumId).collection("fotos").orderBy("nu_sequencia").get().then((t=>t.forEach((t=>{let s=t.data().nu_sequencia;s<3&&e.push(t.data().im_foto)}))),setTimeout((()=>{this.$firebase.firestore().collection("acompanhante").doc(this.userUid).set({im_foto_1:e[0],im_foto_2:e[1],im_foto_3:e[2]},{merge:!0})}),1500))},toOrderImages(){this.$firebase.firestore().collection("acompanhante").doc(this.userUid).collection("albuns").doc(this.albumId).collection("fotos").orderBy("nu_sequencia").get().then((()=>{0!==this.newOrder.length?(this.$q.loading.show({spinner:c["a"],spinnerColor:"purple",message:"Reordenando as fotos"}),this.newOrder.forEach(((e,t)=>{this.$firebase.firestore().collection("acompanhante").doc(this.userUid).collection("albuns").doc(this.albumId).collection("fotos").doc(e.id).set({nu_sequencia:t},{merge:!0}).then((()=>{this.newOrder.length-1===t&&this.$q.notify({type:"positive",message:"Ordem alterada com sucesso"})})).catch((e=>{console.error(e),this.$q.notify({type:"negative",message:"Erro ao reordenar as fotos"})})).finally((()=>{this.newOrder.length-1===t&&this.$q.loading.hide()}))}))):this.$q.notify({type:"info",message:"altere a ordem para poder salvar"})}))}}),mounted(){if(this.deleteImage=Object(d["a"])(this.deleteImage,500),this.onResize=Object(d["a"])(this.onResize,200),this.onResize(),0!==this.$store.state.fotosEvideos.photosAlbum.length){let e=this.$store.state.fotosEvideos.photosAlbum.some((e=>e.albumId===this.albumId));e||this.getPhotosAlbum({userUid:this.userUid,albumId:this.albumId})}else this.getPhotosAlbum({userUid:this.userUid,albumId:this.albumId})}},b=m,f=(s("659d"),s("2877")),g=s("de5e"),v=s("9564"),y=s("9c40"),w=s("7d53"),O=s("3980"),q=s("eebe"),I=s.n(q),$=Object(f["a"])(b,a,n,!1,null,"6005f1ba",null),C=$.exports;I()($,"components",{QPageSticky:g["a"],QToggle:v["a"],QBtn:y["a"],QFile:w["a"],QResizeObserver:O["a"]});var x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{width:"100%"}},[s("q-page-sticky",{ref:"optionsSticker",staticClass:"options-order",class:[{"bg-grey-9":e.$q.dark.isActive},{"bg-grey-4":!e.$q.dark.isActive}],attrs:{position:"top",expand:""}},[s("div",{staticClass:"col-12  w-100 row justify-between items-center q-px-sm"},[s("div",[e.isDisabled?e._e():s("q-btn",{staticClass:"col",attrs:{label:"Salvar",color:"green",size:"sm"},on:{click:e.toOrderVideos}})],1),s("div",[s("q-toggle",{staticClass:"col",attrs:{color:"purple",label:"ordenar",value:!e.isDisabled},on:{input:function(t){e.isDisabled=!e.isDisabled}}})],1)])]),s("draggable",e._b({attrs:{disabled:e.isDisabled},model:{value:e.videos,callback:function(t){e.videos=t},expression:"videos"}},"draggable",e.dragOptions,!1),[s("transition-group",{staticClass:"col-12 row q-col-gutter-xs",attrs:{type:"transition",name:"flip-list"}},e._l(e.videos,(function(t,o){return s("div",{key:t[0].id,staticClass:"col-12 col-sm-6 col-md-4 row",class:{"expanded-container":e.expanded},staticStyle:{"max-height":"250px"}},[s("div",{staticClass:"relative-position w-100",staticStyle:{height:"100%"},on:{mouseenter:function(t){return e.playVideo(t,o)},contextmenu:function(e){e.preventDefault()}}},[s("q-media-player",{ref:"myPlayer",refInFor:!0,staticClass:"myvideo",staticStyle:{height:"100%",width:"100%"},attrs:{sources:t,overlay:""}}),s("q-btn",{staticClass:"absolute-top-right text-capitalize",attrs:{label:"Excluir",flat:"",color:"red"},on:{click:function(s){return e.deleteVideo(t[0])}}})],1)])})),0)],1),s("DialogMedia",{attrs:{isOpen:e.isOpen,video:!0,typeMedia:".avi, .mpeg, .mp4"},on:{hide:function(t){e.isOpen=t}}}),s("q-page-sticky",{staticStyle:{"z-index":"2"},attrs:{position:"bottom-right",offset:[18,18]}},[s("q-btn",{attrs:{fab:"",icon:"add",color:"accent"},on:{click:e.openDialog}})],1),s("q-resize-observer",{on:{resize:e.onResize}})],1)},A=[],k={props:{expanded:{type:Boolean,required:!0},albumId:{type:String,required:!0}},data(){return{isOpen:!1,isDisabled:!0,newOrder:[]}},computed:l()(l()({},Object(u["d"])({userUid:e=>e.acompanhantes.userId,videosAlbum:e=>e.fotosEvideos.videosAlbum})),{},{videos:{get(){let e=[];return this.videosAlbum.forEach((t=>{t.albumId===this.$route.params.albumId&&(e=[...t.videos])})),e},set(e){this.newOrder=[],this.newOrder=[...e],this.$store.commit("fotosEvideos/updateOrderVideos",{albumId:this.albumId,videos:e})}},dragOptions(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}}),components:{DialogMedia:()=>Promise.all([s.e(0),s.e(18)]).then(s.bind(null,"ef2f")),draggable:p.a},methods:l()(l()({},Object(u["b"])({getVideosAlbum:"fotosEvideos/getVideosAlbum",deleteVideoAlbum:"fotosEvideos/deleteVideoAlbumAction"})),{},{playVideo(e,t){e.preventDefault(),this.$refs.myPlayer[`${t}`].$media.play(),this.$refs.myPlayer.forEach(((e,s)=>{t!==s&&e.$media.pause()}))},getFile(e){},openDialog(){this.isOpen=!0},toOrderVideos(){this.$firebase.firestore().collection("acompanhante").doc(this.userUid).collection("albuns").doc(this.albumId).collection("videos").orderBy("nu_sequencia").get().then((()=>{0!==this.newOrder.length?(this.$q.loading.show({spinner:c["a"],spinnerColor:"purple",message:"Reordenando as fotos"}),this.newOrder.forEach(((e,t)=>{this.$firebase.firestore().collection("acompanhante").doc(this.userUid).collection("albuns").doc(this.albumId).collection("videos").doc(e[0].id).set({nu_sequencia:t},{merge:!0}).then((()=>{this.newOrder.length-1===t&&this.$q.notify({type:"positive",message:"Ordem alterada com sucesso"})})).catch((e=>{console.error(e),this.$q.notify({type:"negative",message:"Erro ao reordenar as fotos"})})).finally((()=>{this.newOrder.length-1===t&&this.$q.loading.hide()}))}))):this.$q.notify({type:"info",message:"altere a ordem para poder salvar"})}))},deleteVideo(e){console.log(e),this.$q.loading.show(),fetch(e.src).then((e=>e.blob())).then((t=>{this.deleteVideoAlbum({videoId:e.id,albumId:this.albumId,video:t})}))},onResize(e){e&&(this.widthContainer=e.width,this.$refs.optionsSticker.$el.style.width=e.width-96+"px"),this.expanded&&(this.$refs.optionsSticker.$el.style.left="340px")}}),mounted(){if(this.playVideo=Object(d["a"])(this.playVideo,500),this.onResize=Object(d["a"])(this.onResize,500),this.onResize(),0!==this.$store.state.fotosEvideos.videosAlbum.length){let e=this.$store.state.fotosEvideos.videosAlbum.some((e=>e.albumId===this.albumId));if(!e)if(this.userUid)this.getVideosAlbum({userUid:this.userUid,albumId:this.albumId});else{let e=this.$firebase.auth().currentUser;this.$firebase.firestore().collection("auth").doc(e.uid).get().then((e=>{this.getVideosAlbum({userUid:e.data().id_acompanhante,albumId:this.albumId})}))}}else if(this.userUid)this.getVideosAlbum({albumId:this.$route.params.albumId});else{let e=this.$firebase.auth().currentUser;this.$firebase.firestore().collection("auth").doc(e.uid).get().then((e=>{this.getVideosAlbum({userUid:e.data().id_acompanhante,albumId:this.albumId})}))}}},D=k,E=(s("36ee"),Object(f["a"])(D,x,A,!1,null,"d88be7b2",null)),S=E.exports;I()(E,"components",{QPageSticky:g["a"],QBtn:y["a"],QToggle:v["a"],QResizeObserver:O["a"]});var _={props:["expanded","album"],data(){return{dialog:!1,tab:"fotos",component:"Photos",currentAlbum:""}},methods:{toggleComponent(){"fotos"===this.tab?(this.tab="videos",this.component="Videos"):(this.tab="fotos",this.component="Photos")},showInfo(){this.dialog=!0}},components:{DialogAlbum:()=>Promise.all([s.e(0),s.e(37)]).then(s.bind(null,"abf9")),Photos:C,Videos:S}},P=_,z=(s("dbd2"),s("0016")),U=s("7ff0"),V=s("429b"),j=s("7460"),R=Object(f["a"])(P,o,i,!1,null,null,null);t["default"]=R.exports;I()(R,"components",{QIcon:z["a"],QFooter:U["a"],QTabs:V["a"],QTab:j["a"]})}}]);