(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[37,36],{abf9:function(t,o,e){"use strict";e.r(o);var i=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("q-dialog",{attrs:{value:t.isOpen,persistent:""},on:{hide:t.closeDialog}},[e("q-card",[e("q-card-section",{staticClass:"row justify-between"},[t.isEdit?e("div",{staticClass:"text-h6"},[t._v("Edite o Álbum")]):e("div",{staticClass:"text-h6"},[t._v("Adicione um Álbum")]),t.isEdit?e("q-btn",{attrs:{label:"Excluir",loading:t.loadingBtnDelete,icon:"delete",color:"red",flat:""},on:{click:function(o){return t.deleteAlbum()}}}):t._e()],1),e("q-form",{on:{submit:function(o){t.isEdit?t.editAlbum():t.addAlbum()}}},[e("q-card-section",[e("div",{staticClass:"row q-col-gutter-md"},[e("div",{staticClass:"col-12"},[e("q-input",{attrs:{label:"Nome do álbum",filled:"",color:"purple",rules:[function(t){return!(0===t.length)||"Esse campo é requerido"}]},model:{value:t.noAlbum,callback:function(o){t.noAlbum=o},expression:"noAlbum"}})],1),e("div",{staticClass:"col-12"},[e("q-input",{attrs:{label:"Descrição do Álbum",filled:"",color:"purple",rules:[function(t){return!(0===t.length)||"Esse campo é requerido"}]},model:{value:t.dsAlbum,callback:function(o){t.dsAlbum=o},expression:"dsAlbum"}})],1),e("div",{staticClass:"col-12"},[e("q-input",{staticClass:"col-12 col-md-3 ",attrs:{label:"Data do ensaio","input-class":"cursor-pointer",readonly:"",filled:"",color:"purple",rules:[function(t){return!(0===t.length)||"Esse campo é requerido"}]},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}})]},proxy:!0}]),model:{value:t.dtEnsaio,callback:function(o){t.dtEnsaio=o},expression:"dtEnsaio"}},[e("q-popup-proxy",{staticStyle:{"min-width":"0"},attrs:{breakpoint:500}},[e("q-date",{attrs:{mask:"DD/MM/YYYY",color:"purple"},on:{input:t.setTimestampDtEnsaio},model:{value:t.dtEnsaio,callback:function(o){t.dtEnsaio=o},expression:"dtEnsaio"}},[e("div",{staticClass:"row items-center justify-end"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Concluído",color:"purple",flat:""}})],1)])],1)],1)],1),e("div",{staticClass:"col-12"},[e("q-input",{attrs:{label:"Nome do estúdio",filled:"",color:"purple",rules:[function(t){return!(0===t.length)||"Esse campo é requerido"}]},model:{value:t.noEstudio,callback:function(o){t.noEstudio=o},expression:"noEstudio"}})],1),e("div",{staticClass:"col-12"},[e("q-input",{attrs:{label:"Nome do Fotógrafo",filled:"",color:"purple",rules:[function(t){return!(0===t.length)||"Esse campo é requerido"}]},model:{value:t.noFotografo,callback:function(o){t.noFotografo=o},expression:"noFotografo"}})],1),e("div",{staticClass:"col-12"},[e("q-file",{attrs:{filled:"",color:"purple",label:"Foto de capa",accept:".jpg, image/*",rules:[function(o){return o||t.isEdit||"Imagem é requerida"}]},scopedSlots:t._u([{key:"append",fn:function(){return[e("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:t.imAlbum,callback:function(o){t.imAlbum=o},expression:"imAlbum"}})],1)])]),e("q-card-actions",{attrs:{align:"right"}},[t.isEdit?e("q-btn",{attrs:{flat:"",label:"Salvar",color:"purple",type:"submit",loading:t.loadingBtnSave}}):e("q-btn",{attrs:{flat:"",label:"Adicionar",color:"purple",type:"submit",icon:"add",loading:t.loadingBtnAdd}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Fechar",color:"red",disable:t.loadingBtnSave||t.loadingBtnAdd||t.loadingBtnDelete}})],1)],1)],1)],1)},a=[],s=e("ded3"),l=e.n(s),n=e("2f62"),d={props:{isOpen:{type:Boolean,required:!0},album:{type:Object,required:!1},isEdit:{type:Boolean,required:!0}},data(){return{noAlbum:"",dsAlbum:"",dtEnsaio:"",dtEnsaioTimeStamp:"",noEstudio:"",noFotografo:"",imAlbum:null,imAlbumURL:""}},watch:{isOpen(){if(this.isOpen&&this.isEdit){this.noAlbum=this.album.no_album,this.dsAlbum=this.album.ds_album;let t=this.album.dt_ensaio.toDate().getDate(),o=this.album.dt_ensaio.toDate().getMonth()<10?`0${this.album.dt_ensaio.toDate().getMonth()}`:this.album.dt_ensaio.toDate().getMonth(),e=this.album.dt_ensaio.toDate().getFullYear();this.dtEnsaio=`${t}/${o}/${e}`,this.noEstudio=this.album.no_estudio,this.noFotografo=this.album.no_fotografo}},loadingBtnDelete(){this.loadingBtnDelete||(this.$emit("closeDialog"),"/gallery/albuns"!==this.$route.path&&this.$router.back())},loadingBtnSave(){this.loadingBtnSave||this.$emit("closeDialog")}},computed:l()({},Object(n["d"])({userUid:t=>t.acompanhantes.userId,albuns:t=>t.fotosEvideos.albuns,loadingBtnDelete:t=>t.fotosEvideos.loadingBtnDelete,loadingBtnSave:t=>t.fotosEvideos.loadingBtnSave,loadingBtnAdd:t=>t.fotosEvideos.loadingBtnAdd})),methods:l()(l()(l()({},Object(n["c"])({changeStateLoadingBtnAdd:"fotosEvideos/changeStateLoadingBtnAdd",changeStateLoadingBtnSave:"fotosEvideos/changeStateLoadingBtnSave"})),Object(n["b"])({setImageBackgroundAlbumAction:"fotosEvideos/setImageBackgroundAlbumAction",deleteAlbumAction:"fotosEvideos/deleteAlbumAction",updateAlbumAction:"fotosEvideos/updateAlbumAction"})),{},{addAlbum(){this.changeStateLoadingBtnAdd(!0),this.$firebase.firestore().collection("acompanhante").doc(this.userUid).collection("albuns").add({no_album:this.noAlbum,ds_album:this.dsAlbum,dt_ensaio:this.dtEnsaioTimeStamp,no_estudio:this.noEstudio,no_fotografo:this.noFotografo,dh_inclusao:new Date,nu_sequencia:this.albuns.length}).then((t=>{this.sendImageToStorage(t.id)}))},setTimestampDtEnsaio(t,o,e){this.dtEnsaioTimeStamp=new Date(e.year,e.month,e.day)},sendImageToStorage(t){let o=this.$firebase.storage().ref();o=o.child(`albuns/background/${t}`),o.put(this.imAlbum).then((()=>{this.$emit("closeDialog"),o.getDownloadURL().then((o=>{this.setImageBackgroundAlbumAction({url:o,albumId:t})}))}))},editAlbum(){let t;if(this.changeStateLoadingBtnSave(!0),t=this.dtEnsaioTimeStamp?this.dtEnsaioTimeStamp:this.album.dt_ensaio,this.imAlbum){let t=this.$firebase.storage().ref().child(`albuns/background/${this.album.albumId}`);t.put(this.imAlbum).then((e=>{t.getDownloadURL().then((t=>{this.imAlbumURL=t,o.call(this)}))}))}else this.updateAlbumAction({albumId:this.album.albumId,noAlbum:this.noAlbum,dsAlbum:this.dsAlbum,dtEnsaio:t,noEstudio:this.noEstudio,noFotografo:this.noFotografo});function o(){this.updateAlbumAction({albumId:this.album.albumId,noAlbum:this.noAlbum,dsAlbum:this.dsAlbum,dtEnsaio:t,noEstudio:this.noEstudio,noFotografo:this.noFotografo,imAlbum:this.imAlbumURL})}},deleteAlbum(){this.deleteAlbumAction(this.album)},closeDialog(){this.noAlbum="",this.dsAlbum="",this.dtEnsaio="",this.noEstudio="",this.noFotografo="",this.imAlbum=null,this.$emit("closeDialog")}}),created(){}},u=d,r=e("2877"),c=e("24e8"),m=e("f09f"),b=e("a370"),p=e("9c40"),h=e("0378"),g=e("27f9"),f=e("0016"),A=e("7cbe"),E=e("52ee"),v=e("7d53"),q=e("4b7e"),D=e("7f67"),B=e("eebe"),S=e.n(B),_=Object(r["a"])(u,i,a,!1,null,null,null);o["default"]=_.exports;S()(_,"components",{QDialog:c["a"],QCard:m["a"],QCardSection:b["a"],QBtn:p["a"],QForm:h["a"],QInput:g["a"],QIcon:f["a"],QPopupProxy:A["a"],QDate:E["a"],QFile:v["a"],QCardActions:q["a"]}),S()(_,"directives",{ClosePopup:D["a"]})}}]);